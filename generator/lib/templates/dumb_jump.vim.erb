" NOTES:
" - All language regular expressions are ported from https://github.com/jacktasia/dumb-jump/blob/master/dumb-jump.el

let s:tools = {
<% tools.each do |language, supports| -%>
      \ '<%= language %>': [<%= supports.map { |engine| "'#{engine}'" }.join(", ") %>],
<% end -%>
      \ }

let s:rules = {
<% rules.each do |language, details| -%>
      \ '<%= language %>': {
<% details.each do |key, value| -%>
      \   '<%= key %>': [
<% value.each do |regex| -%>
      \     <%= "'#{regex}'" %>,
<% end -%>
      \   ],
<% end -%>
      \ },
<% end -%>
      \ }

let s:definitions = {
<% definitions.each do |language, rules| -%>
      \ '<%= language %>': [
<% rules.each do |rule| -%>
      \   {
      \     'type': '<%= rule[:type] %>',
      \     'pcre_regex': '<%= rule[:pcre_regex_vim] %>',
      \     'regex': '<%= rule[:regex_vim] %>',
      \     'supports': [<%= rule[:supports].map { |engine| "'#{engine}'" }.join(", ") %>],
      \   },
<% end -%>
      \ ],
<% end -%>
      \ }

function! <%= namespace %>#get(...) abort
  let ft = get(a:, 1, &filetype !=# '' ? &filetype : &buftype)
  if has_key(s:definitions, ft)
    return s:definitions[ft]
  endif
  return []
endfunction
